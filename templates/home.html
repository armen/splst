<!DOCTYPE html>
<html>
    {{template "head" .}}
    <body>
        <div class="container">
            <div class="row">
                {{template "header" .}}
            </div>
            <div class="row">
                <div id="add-project-container" style="display:none;">
                    <div id="upload-message" class="alert alert-success" style="display:none;">
                        <h4>Woot!</h4>
                        <p>Successfully created the project.</p>
                    </div>
                    <div id="error-block" class="alert alert-error" style="display:none;">
                        <button type="button" class="close closeit" data-dismiss="alert">Ã—</button>
                        <h4>Oops!</h4>
                        <p id="error-message"></p>
                    </div>
                    <form class="form-horizontal" id="add-project">
                        <div id="url-group" class="first-stage control-group">
                            <label class="control-label" for="url">Project URL</label>
                            <div class="controls">
                                <input type="text" name="url" id="url" placeholder="Project URL" class="input-xxlarge">
                                <span class="help-inline">Must be a fully qualified URL that includes <b>http://</b> or <b>https://</b></span>
                            </div>
                        </div>
                        <div id="name-group" class="second-stage control-group" style="display:none;">
                            <label class="control-label" for="name">Project Name</label>
                            <div class="controls">
                                <input type="text" name="name" id="name" placeholder="Project Name" class="input-medium">
                                <span class="help-inline"></span>
                            </div>
                        </div>
                        <div id="description-group" class="second-stage control-group" style="display:none;">
                            <label class="control-label" for="description">Description</label>
                            <div class="controls">
                                <textarea name="description" id="description" rows="2" class="input-xxlarge"></textarea>
                            </div>
                        </div>
                        <div id="code-repo-group" class="second-stage control-group" style="display:none;">
                            <label class="control-label" for="code-repo">Code Repository</label>
                            <div class="controls">
                                <input type="text" name="code-repo" id="code-repo" class="input-xlarge">
                            </div>
                        </div>
                        <div class="controls">
                            <button type="button" class="btn btn-success" id="fetch">Fetch</button>
                            <button type="submit" class="btn btn-success" id="add" style="display:none;">Submit</button>
                            <button type="button" class="btn add-project" id="close">Close</button>
                            <button type="button" class="btn" id="clear" style="display:none;">Clear & Close</button>
                        </div>
                    </form>
                </div>
            </div>
            <div class="row">
                {{if .newcomer}}
                <div id="first-time-uploader-container">
                    <div class="alert alert-success" style="text-align:center">
                        <h4>Hurry up!</h4>
                        <p>You haven't added any projects yet. It's very simple and no need for registration.</p>
                        <button type="button" class="btn btn-success btn-large add-project closeit">Submit your project's link in two simple steps</button>
                    </div>
                </div>
                {{end}}
                <ul id="projects" class="thumbnails" style="position: relative;">
                {{range .projects}}
                    {{if .}}
                    <li class="span4"{{if .Mine $.userid}} id="container-{{.Id}}"{{end}}>
                        <div class="thumbnail">
                            {{if .Mine $.userid}}
                            <div id="{{.Id}}" class="alert">
                                <p>Do you really want to delete this project?</p>
                                <div class="controls">
                                    <button type="button" class="btn btn-danger btn-small delete" data-pid="{{.Id}}">Yes</button>&nbsp;&nbsp;&nbsp;&nbsp;
                                    <button type="button" class="btn btn-success btn-small toggle-delete" data-pid="{{.Id}}">No</button>
                                </div>
                            </div>
                            <div id="error-{{.Id}}" class="alert alert-error">
                                <b>Oops!</b>
                                <p>There was a problem deleting this project. Please try later.</p>
                            </div>
                            {{end}}
                            <div><h4>{{.Name | printf "%.30s"}}</h4></div>
                            <div class="separator">&nbsp;</div>
                            {{if .Thumb}}
                                <a href="{{.URL}}"><img src="static/projects/{{.OwnerId}}/{{.Id}}/small.jpg"></a>
                            {{else}}
                                <a href="{{.URL}}"><img src="static/img/noimg.jpg"></a>
                            {{end}}
                            <div class="separator">&nbsp;</div>
                            <div class="btn-group">
                                <a class="btn" title="Homepage" href="{{.URL}}"><i class="icon-home"></i></a>
                                {{if .RepositoryURL}}&nbsp;<a class="btn" title="Code repository" target="_blank" href="{{.RepositoryURL}}"><i class="icon-flag"></i></a>{{end}}
                                {{if .Mine $.userid}}<a class="btn toggle-delete" title="Delete" target="_blank" data-pid="{{.Id}}"><i class="icon-trash"></i></a>{{end}}
                            </div>
                        </div>
                    </li>
                    {{end}}
               {{end}}
                </ul>
            </div>
        </div>
        {{template "scripts"}}
    </body>
</html>
